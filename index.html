<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Installation Report Form</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap');

        body {
            font-family: 'Roboto', Arial, sans-serif;
            margin: 0;
            padding: 0;
            background: linear-gradient(rgba(0, 0, 0, 0.5),
                    rgba(0, 0, 0, 0.5)),
                url('finalbg.jpg') no-repeat center center;
            background-size: cover;
            background-position: center center;
            background-attachment: fixed;
            color: #333;
            line-height: 1.6;
            animation: fadeIn 1.5s ease-in;
        }


        @keyframes fadeIn {
            from {
                opacity: 0;
            }

            to {
                opacity: 1;
            }
        }

        #particles-js {
            position: absolute;
            width: 100%;
            height: 100%;
            z-index: -1;
        }
        .header {
            text-align: center;
            margin-bottom: 20px;
            animation: slideDown 1s ease-out;
        }

        @keyframes slideDown {
            from {
                transform: translateY(-50px);
                opacity: 0;
            }

            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        .header img {
            height: 80px;
        }

        .header h1 {
            font-size: 30px;
            font-weight: 700;
            color: #ff9800;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        .form-container {
            background: rgba(255, 255, 255, 0.9);
            border: 1px solid #ddd;
            border-radius: 12px;
            padding: 25px;
            max-width: 900px;
            margin: auto;
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.4);
            transition: transform 0.3s ease-in-out, box-shadow 0.3s;
        }

        .form-container:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(255, 152, 0, 0.5);
        }

        .form-section {
            margin-bottom: 25px;
        }

        .form-section h3 {
            font-size: 20px;
            font-weight: 700;
            color: #ff9800;
            border-left: 4px solid #ff9800;
            padding-left: 12px;
            margin-bottom: 15px;
        }

        .form-section table {
            width: 100%;
            border-collapse: collapse;
        }

        .form-section table td {
            padding: 12px;
            vertical-align: middle;
            font-size: 16px;
            color: #222;
        }

        .form-section table input,
        .form-section table select {
            width: 95%;
            padding: 10px;
            border: 1px solid #ccc;
            border-radius: 8px;
            font-size: 15px;
            box-sizing: border-box;
            background: #f9f9f9;
            color: #444;
            transition: all 0.3s ease;
        }

        .form-section table input:focus,
        .form-section table select:focus {
            border-color: #ff9800;
            box-shadow: 0 0 8px rgba(255, 152, 0, 0.7);
            outline: none;
        }

        .highlight {
            background-color: #fff2d5;
            font-weight: 600;
            color: #d84315;
        }

        .btn-container {
            text-align: center;
            margin-top: 20px;
        }

        .btn-container button {
            background-color: #d84315;
            color: #fff;
            border: none;
            padding: 12px 25px;
            font-size: 18px;
            font-weight: 600;
            border-radius: 8px;
            cursor: pointer;
            transition: background 0.3s ease, transform 0.2s ease, box-shadow 0.3s;
        }

        .btn-container button:hover {
            background-color: #ff9800;
            transform: translateY(-3px);
            box-shadow: 0 6px 15px rgba(255, 152, 0, 0.5);
        }

        .footer {
            text-align: center;
            margin-top: 20px;
        }

.footer {
    text-align: center;
    margin-top: 20px;
}

.footer img {
    height: 80px;
    width: auto;
    filter: drop-shadow(0 0 2px rgba(255, 152, 0, 0.5)) drop-shadow(0 0 5px rgba(255, 152, 0, 0.3));
    transition: filter 0.3s ease;
}

.footer img:hover {
    filter: drop-shadow(0 0 4px rgba(255, 152, 0, 0.7)) drop-shadow(0 0 8px rgba(255, 152, 0, 0.5));
}



        .footer p {
            font-size: 14px;
            color: #888;
            margin-top: 10px;
        }
        @media screen and (max-width: 768px) {
            .form-container {
                padding: 15px;
            }

            .header h1 {
                font-size: 24px;
            }

            .btn-container button {
                font-size: 16px;
                padding: 10px 20px;
            }
        }
    </style>
</head>

<body>
    <div id="particles-js"></div>

    <div class="header">
        <img src="sc-solarhd(logo).jpg" alt="GoRenew Logo">
        <h1>Installation Report Form</h1>
    </div>

    <div class="form-container">
        <form>
            <div class="form-section">
                <table style="width: 100%; border-collapse: collapse;">
                    <tr>
                        <td style="width: 30%;"><strong>Format No.:</strong></td>
                        <td style="width: 70%;"><input type="text" placeholder="Enter Format No." style="width: 95%;">
                        </td>
                    </tr>
                    <tr>
                        <td style="width: 30%;"><strong>Rev00:</strong></td>
                        <td style="width: 70%;"><input type="text" placeholder="Enter Rev" style="width: 95%;"></td>
                    </tr>
                    <tr>
                        <td style="width: 30%;"><strong>Installation Report For:</strong></td>
                        <td style="width: 70%;"><input type="text" placeholder="Enter Report Type" style="width: 95%;">
                        </td>
                    </tr>
                </table>

            </div>
            <div class="form-section">
                <h3>1. Inverter Details</h3>
                <table>
                    <tr>
                        <td><strong>1.1 Inverter Model Number</strong></td>
                        <td>
                            <select>
                                <option value="GH-3500 Series">GH-3500 Series</option>
                                <option value="GH-5500 Series">GH-5500 Series</option>
                                <option value="GH-6200 Series">GH-6200 Series</option>
                            </select>
                        </td>
                    </tr>
                    <tr>
                        <td><strong>1.2 Type of Installation</strong></td>
                        <td>
                            <select>
                                <option value="Fresh Installation">Fresh Installation</option>
                                <option value="Replacement Installation">Replacement Installation</option>
                                <option value="Site Change Installation">Site Change Installation</option>
                            </select>
                        </td>
                    </tr>
                    <tr>
                        <td><strong>1.3 Inverter Serial Number</strong></td>
                        <td><input type="text" placeholder="Enter Serial Number"></td>
                    </tr>
                    <tr>
                        <td><strong>1.4 Old Inverter Serial Number</strong></td>
                        <td><input type="text" placeholder="Enter Old Serial Number"></td>
                    </tr>
                </table>
            </div>
            <div class="form-section">
                <h3>2. PV Stringing Design with Parameters</h3>
                <table>
                    <tr>
                        <td><strong>Details</strong></td>
                        <td><strong>MPP1</strong></td>
                        <td><strong>MPP2</strong></td>
                        <td><strong>MPP3</strong></td>
                    </tr>
                    <tr>
                        <td>No. of Modules in Series in Each String</td>
                        <td><input type="number" placeholder="0"></td>
                        <td><input type="number" placeholder="0"></td>
                        <td><input type="number" placeholder="0"></td>
                    </tr>
                    <tr>
                        <td>No. of Such Strings per MPP</td>
                        <td><input type="number" placeholder="0"></td>
                        <td><input type="number" placeholder="0"></td>
                        <td><input type="number" placeholder="0"></td>
                    </tr>
                    <tr>
                        <td class="highlight">Number of Modules per MPPT</td>
                        <td><input type="number" placeholder="0"></td>
                        <td><input type="number" placeholder="0"></td>
                        <td><input type="number" placeholder="0"></td>
                    </tr>
                    <tr>
                        <td>Wp Ratings of Modules on Each Tracker</td>
                        <td><input type="number" placeholder="0"></td>
                        <td><input type="number" placeholder="0"></td>
                        <td><input type="number" placeholder="0"></td>
                    </tr>
                    <tr>
                        <td class="highlight">Total PV Generator Power at STC (Wp)</td>
                        <td colspan="3"><input type="number" placeholder="0"></td>
                    </tr>
                    <tr>
                        <td>Declared Voc of the PV Modules at STC</td>
                        <td><input type="number" placeholder="0.00"></td>
                        <td><input type="number" placeholder="0.00"></td>
                        <td><input type="number" placeholder="0.00"></td>
                    </tr>
                    <tr>
                        <td class="highlight">Expected Open Circuit Voltage (V) of the PV Strings at STC</td>
                        <td><input type="number" placeholder="0.00"></td>
                        <td><input type="number" placeholder="0.00"></td>
                        <td><input type="number" placeholder="0.00"></td>
                    </tr>
                </table>
            </div>
            <div class="form-section">
                <h3>3. Grid Parameters Observed at the Time of Start-up</h3>
                <table>
                    <tr>
                        <td><strong>Parameters</strong></td>
                        <td><strong>PE</strong></td>
                        <td colspan="3" style="text-align: center;"><strong>Observed on Inverter LCD</strong></td>
                    </tr>
                    <tr>
                        <td></td>
                        <td>Measured</td>
                        <td>L1</td>
                        <td>L2</td>
                        <td>L3</td>
                    </tr>
                    <tr>
                        <td>Voltage with Respect to Neutral – Without Inverter Feed (V)</td>
                        <td><input type="number" placeholder="Enter value"></td>
                        <td><input type="number" placeholder="Enter value"></td>
                        <td><input type="number" placeholder="Enter value"></td>
                        <td><input type="number" placeholder="Enter value"></td>
                    </tr>
                    <tr>
                        <td>Voltage with Respect to Neutral – With Inverter Feed (V)</td>
                        <td><input type="number" placeholder="Enter value"></td>
                        <td><input type="number" placeholder="Enter value"></td>
                        <td><input type="number" placeholder="Enter value"></td>
                        <td><input type="number" placeholder="Enter value"></td>
                    </tr>
                    <tr>
                        <td>Feed In Current (Amps) – During Inverter Feed</td>
                        <td><input type="number" placeholder="Enter value"></td>
                        <td><input type="number" placeholder="Enter value"></td>
                        <td><input type="number" placeholder="Enter value"></td>
                        <td><input type="number" placeholder="Enter value"></td>
                    </tr>
                    <tr>
                        <td>Feed in Power (kW) – During Inverter Feed</td>
                        <td><input type="number" placeholder="Enter value"></td>
                        <td><input type="number" placeholder="Enter value"></td>
                        <td><input type="number" placeholder="Enter value"></td>
                        <td><input type="number" placeholder="Enter value"></td>
                    </tr>
                </table>
            </div>
            <div class="form-section">
                <h3>4. PV String Parameters Observed at the Time of Start-up</h3>
                <table>
                    <tr>
                        <td><strong>Parameter</strong></td>
                        <td><strong>MPP1</strong></td>
                        <td><strong>MPP2</strong></td>
                        <td><strong>MPP3</strong></td>
                    </tr>
                    <tr>
                        <td>Open Circuit String Voltage (VDC)</td>
                        <td><input type="number" placeholder="Enter value"></td>
                        <td><input type="number" placeholder="Enter value"></td>
                        <td><input type="number" placeholder="Enter value"></td>
                    </tr>
                    <tr>
                        <td>String Voltage at MPP (VDC)</td>
                        <td><input type="number" placeholder="Enter value"></td>
                        <td><input type="number" placeholder="Enter value"></td>
                        <td><input type="number" placeholder="Enter value"></td>
                    </tr>
                    <tr>
                        <td>String Current at MPP (Amps)</td>
                        <td><input type="number" placeholder="Enter value"></td>
                        <td><input type="number" placeholder="Enter value"></td>
                        <td><input type="number" placeholder="Enter value"></td>
                    </tr>
                    <tr>
                        <td>String Power at MPP (kW)</td>
                        <td><input type="number" placeholder="Enter value"></td>
                        <td><input type="number" placeholder="Enter value"></td>
                        <td><input type="number" placeholder="Enter value"></td>
                    </tr>
                </table>
            </div>
            <div class="form-section">
                <h3>5. Parameter Settings</h3>
                <table>
                    <tr>
                        <td><strong>Output Source Priority</strong></td>
                        <td>
                            <select>
                                <option value="Utility First">Utility First (Default)</option>
                                <option value="Solar First">Solar First</option>
                                <option value="SBU Priority">SBU Priority</option>
                                <option value="SUB Priority">SUB Priority</option>
                                <option value="SUF Priority">SUF Priority</option>
                            </select>
                        </td>
                    </tr>
                    <tr>
                        <td><strong>AC Input Voltage Range</strong></td>
                        <td>
                            <select>
                                <option value="Appliances">Appliances (Default)</option>
                                <option value="UPS">UPS</option>
                                <option value="Generator">Generator</option>
                            </select>
                        </td>
                    </tr>
                    <tr>
                        <td><strong>Battery Type</strong></td>
                        <td>
                            <select>
                                <option value="AGM">AGM (Default)</option>
                                <option value="User-Defined">User-Defined</option>
                                <option value="LI 2">LI 2</option>
                                <option value="LI 4">LI 4</option>
                                <option value="LIB">LIB</option>
                            </select>
                        </td>
                    </tr>
                    <tr>
                        <td><strong>Setting Voltage or SOC Back to Utility Source (SBU Priority)</strong></td>
                        <td>
                            <input type="text" value="46.0 V">
                            <input type="text" value="50%">
                        </td>
                    </tr>
                    <tr>
                        <td><strong>Setting Voltage or SOC Back to Battery Mode (SBU Priority)</strong></td>
                        <td>
                            <input type="text" value="Battery Full">
                            <input type="text" placeholder="Enter SOC %">
                        </td>
                    </tr>
                    <tr>
                        <td><strong>Setting Cut-Off Voltage or SOC Percentage (OP2)</strong></td>
                        <td>
                            <input type="text" placeholder="Enter Value">
                        </td>
                    </tr>
                    <tr>
                        <td><strong>Setting Cut-Off Voltage or SOC Percentage (OP1)</strong></td>
                        <td>
                            <input type="text" placeholder="Enter Value">
                        </td>
                    </tr>
                    <tr>
                        <td><strong>Automatic Activation for Lithium Battery</strong></td>
                        <td>
                            <select>
                                <option value="Enabled">Enabled</option>
                                <option value="Disabled">Disabled</option>
                            </select>
                        </td>
                    </tr>
                    <tr>
                        <td><strong>Manual Activation for Lithium Battery</strong></td>
                        <td>
                            <select>
                                <option value="Enabled">Enabled</option>
                                <option value="Disabled">Disabled</option>
                            </select>
                        </td>
                    </tr>
                </table>
            </div>
            <!--Other Details Section-->
            <div class="form-section">
                <h3>6. Other Details</h3>
                <table>
                    <tr>
                        <td><strong>External DC Junction Box with Surge Suppressors Used</strong></td>
                        <td>
                            <select>
                                <option value="YES">YES</option>
                                <option value="NO">NO</option>
                            </select>
                        </td>
                    </tr>
                    <tr>
                        <td><strong>External AC Circuit Breaker Used Close to the Inverter</strong></td>
                        <td>
                            <select>
                                <option value="YES">YES</option>
                                <option value="NO">NO</option>
                            </select>
                        </td>
                    </tr>
                    <tr>
                        <td><strong>Minimum Clearances around the Inverter Observed</strong></td>
                        <td>
                            <select>
                                <option value="YES">YES</option>
                                <option value="NO">NO</option>
                            </select>
                        </td>
                    </tr>
                    <tr>
                        <td><strong>Unobstructed Air Circulation around Inverter</strong></td>
                        <td>
                            <select>
                                <option value="YES">YES</option>
                                <option value="NO">NO</option>
                            </select>
                        </td>
                    </tr>
                    <tr>
                        <td><strong>Inverter Mounted Firmly on Fireproof Support</strong></td>
                        <td>
                            <select>
                                <option value="YES">YES</option>
                                <option value="NO">NO</option>
                            </select>
                        </td>
                    </tr>
                    <tr>
                        <td><strong>Inverter Chassis Connected to PE</strong></td>
                        <td>
                            <select>
                                <option value="YES">YES</option>
                                <option value="NO">NO</option>
                            </select>
                        </td>
                    </tr>
                    <tr>
                        <td><strong>No Ground Fault on PV Side Verified</strong></td>
                        <td>
                            <select>
                                <option value="YES">YES</option>
                                <option value="NO">NO</option>
                            </select>
                        </td>
                    </tr>
                    <tr>
                        <td><strong>Are Any Shadings of the PV Generator Observed?</strong></td>
                        <td>
                            <select>
                                <option value="YES">YES</option>
                                <option value="NO">NO</option>
                            </select>
                        </td>
                    </tr>
                </table>
            </div>

            <div class="form-section">
                <h3>7. Remarks</h3>
                <textarea rows="5" style="width: 100%; padding: 10px; border: 1px solid #e0e0e0; border-radius: 8px;"
                    placeholder="Enter remarks here..."></textarea>
            </div>

            <div class="form-section">
                <h3>8. Engineer Details</h3>
                <table>
                    <tr>
                        <td><strong>Engineer Name</strong></td>
                        <td><input type="text" placeholder="Enter Name" style="width: 100%;"></td>
                    </tr>
                    <tr>
                        <td><strong>Mobile Number</strong></td>
                        <td><input type="text" placeholder="Enter Mobile Number" style="width: 100%;"></td>
                    </tr>
                </table>
            </div>
            <div class="btn-container">
                <button type="submit">Submit</button>
            </div>
        </form>
    </div>


    <div class="footer">
        <img src="transparent.png" alt="SC Solar Logo">
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>

    <script>
        document.querySelector("form").addEventListener("submit", async function (event) {
            event.preventDefault();


            let formCounter = localStorage.getItem("SCsolarFormCounter");
            formCounter = formCounter ? parseInt(formCounter) + 1 : 1;
            localStorage.setItem("SCsolarFormCounter", formCounter);

            const formNumber = `SCsolarformid${formCounter}`;

            const formElement = document.querySelector("form");
            const submitButton = formElement.querySelector("button[type='submit']");

            submitButton.style.display = "none";

            const canvas = await html2canvas(formElement, { scale: 2 });
            const imgData = canvas.toDataURL("image/png");

            submitButton.style.display = "";

            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();

            const pageWidth = doc.internal.pageSize.getWidth();
            const pageHeight = doc.internal.pageSize.getHeight();
            const imgWidth = pageWidth - 20;
            const imgHeight = (canvas.height * imgWidth) / canvas.width;

            let yOffset = 40;

            doc.setFont("helvetica", "bold");
            doc.setFontSize(18);
            doc.text("Installation Report Form", pageWidth / 2, 20, { align: "center" });
            doc.setFontSize(12);
            doc.text(`Generated on: ${new Date().toLocaleString()}`, pageWidth / 2, 30, { align: "center" });

            doc.setFont("helvetica", "normal");
            doc.setFontSize(12);
            doc.text(`Form No: ${formNumber}`, 10, 40);

            let currentPage = 1;
            let imgY = 0;

            while (imgY < canvas.height) {
                if (currentPage > 1) {
                    doc.addPage();
                }
                const canvasSlice = document.createElement("canvas");
                canvasSlice.width = canvas.width;
                canvasSlice.height = (canvas.width * (pageHeight - yOffset - 10)) / imgWidth; // Proportional slice height
                const ctx = canvasSlice.getContext("2d");
                ctx.drawImage(
                    canvas,
                    0,
                    imgY,
                    canvas.width,
                    canvasSlice.height,
                    0,
                    0,
                    canvasSlice.width,
                    canvasSlice.height
                );

                const sliceData = canvasSlice.toDataURL("image/png");

                const watermarkImg = new Image();
                watermarkImg.src = "sc-solar.jpg";
                doc.addImage(sliceData, "PNG", 10, yOffset, imgWidth, pageHeight - yOffset - 10);
                doc.setPage(currentPage);

                const logoWidth = 100;
                const logoHeight = 40;
                const logoX = (pageWidth - logoWidth) / 2;
                const logoY = (pageHeight - logoHeight) / 2;

                doc.setGState(new doc.GState({ opacity: 0.1 }));
                doc.addImage(watermarkImg, "PNG", logoX, logoY, logoWidth, logoHeight);
                doc.setGState(new doc.GState({ opacity: 1 }));

                imgY += canvasSlice.height;
                currentPage++;
            }

            doc.setFontSize(10);
            const footerTextY = pageHeight - 20;
            doc.text("Thank you for using our service.", pageWidth / 2, footerTextY, { align: "center" });

            const logoURL = "sc-solar.jpg";
            const logoWidth = 40;
            const logoHeight = 15;
            const logoX = (pageWidth - logoWidth) / 2;
            const logoY = footerTextY + 5;

            doc.addImage(logoURL, "PNG", logoX, logoY, logoWidth, logoHeight);

            doc.save(`Installation_Report_${formNumber}.pdf`);
        });
    </script>
    <script src="https://cdn.jsdelivr.net/npm/particles.js"></script>
    <script>
        function setParticleHeight() {
            const particlesContainer = document.getElementById("particles-js");
            particlesContainer.style.height = document.body.scrollHeight + "px";
        }
        particlesJS("particles-js", {
            particles: {
                number: {
                    value: 90,
                    density: { enable: true, value_area: 800 },
                },
                color: { value: "#ff9800" },
                shape: {
                    type: "circle",
                    stroke: { width: 0, color: "#000000" },
                },
                opacity: {
                    value: 0.5,
                    random: false,
                    anim: { enable: false, speed: 1, opacity_min: 0.1, sync: false },
                },
                size: {
                    value: 3,
                    random: true,
                    anim: { enable: false, speed: 40, size_min: 0.1, sync: false },
                },
                line_linked: {
                    enable: true,
                    distance: 150,
                    color: "#ff9800",
                    opacity: 0.4,
                    width: 1,
                },
                move: {
                    enable: true,
                    speed: 3, 
                    direction: "none",
                    random: false,
                    straight: false,
                    out_mode: "out",
                    bounce: false,
                    attract: { enable: false, rotateX: 600, rotateY: 1200 },
                },
            },
            interactivity: {
                detect_on: "canvas",
                events: {
                    onhover: { enable: true, mode: "repulse" },
                    onclick: { enable: true, mode: "push" },
                    resize: true,
                },
                modes: {
                    grab: { distance: 400, line_linked: { opacity: 1 } },
                    bubble: { distance: 400, size: 40, duration: 2, opacity: 8, speed: 3 },
                    repulse: { distance: 100, duration: 0.4 },
                    push: { particles_nb: 4 },
                    remove: { particles_nb: 2 },
                },
            },
            retina_detect: true,
        });
        window.addEventListener("load", setParticleHeight);
        window.addEventListener("resize", setParticleHeight);

    </script>
</body>

</html>